geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
ggplot(data.by_country.average, aes(x=reorder(country.code, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
ggplot(data.by_country.average, aes(x=reorder(country, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'ES', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
#geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
# on average, country where the tax rate is high are keeping the rate constant since 2000
ggplot(subset(data, country.code %in% c('BE', 'DE', 'DK', 'HU', 'AT', 'SI', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'ES', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
#geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'ES', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('BE', 'DE', 'DK', 'HU', 'AT', 'SI', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('BE', 'DE', 'DK', 'HU', 'AT', 'SI', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'ES', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('BE', 'DE', 'DK', 'HU', 'AT', 'SI', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country.code))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', '', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', '', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', '')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', '', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'ES', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'SP', 'PT', 'SK')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'SP', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'SP', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
#stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'SP', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'ES', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'SP', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'ES', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'ES', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'EE', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'EE', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = factor(country))) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data.by_country.average, aes(x=reorder(country, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'EE', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = factor(country))) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data.by_country.average, aes(x=reorder(country, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'SP', 'EE', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = factor(country))) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'ES', 'EE', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = factor(country))) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'ES', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('BE', 'DE', 'DK', 'HU', 'AT', 'SI', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('BE', 'DE', 'DK', 'HU', 'AT', 'SI', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data, aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data, aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data, aes(x=factor(ratio))) +
geom_bar(fill="lightblue") +
theme_bw()
data.by_country.average <- data %>%
group_by(country) %>%
summarise(mean = mean(ratio, na.rm = TRUE)) %>%
arrange(desc(mean))
ggplot(data, aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
summary(data.by_country.average$mean)
data.by_country.average$category <- cut(data.by_country.average$mean,
breaks=c(-Inf,
quantile(data.by_country.average$mean, 0.25),
quantile(data.by_country.average$mean, 0.75),
Inf),
labels=c("low","medium","high"))
ggplot(data, aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data.by_country.average, aes(x=reorder(country, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
View(data.by_country.average)
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'ES', 'EE', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = factor(country))) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'ES', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'ES', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'ES', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('BE', 'DE', 'DK', 'HU', 'AT', 'SI', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('EL', 'IE', 'IT', 'PT', 'SP', 'SI', 'SK', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'ES', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('BE', 'DE', 'DK', 'HU', 'AT', 'SI', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data.by_country.average, aes(x=reorder(country, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'ES', 'EE', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = factor(country))) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('IE', 'ES', 'PT', 'EL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('BE', 'DE', 'DK', 'HU', 'AT', 'SI', 'NL')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(subset(data, country.code %in% c('FI', 'IT', 'LV', 'NO', 'TK', 'FR', 'IS', 'RO', 'SW', 'LU', 'PL', 'UK', 'LT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
data = read.csv('../preprocessing/data/tax_ratio.csv', header=FALSE)
names(data) <- c("year","ratio","country", "country.code")
ggplot(data, aes(x=factor(ratio))) +
geom_bar(fill="lightblue") +
theme_bw()
data.by_country.average <- data %>%
group_by(country) %>%
summarise(mean = mean(ratio, na.rm = TRUE)) %>%
arrange(desc(mean))
ggplot(data, aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data.by_country.average, aes(x=reorder(country, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
ggplot(data.by_country.average, aes(x=reorder(country, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
data = read.csv('../preprocessing/data/tax_ratio.csv', header=FALSE)
names(data) <- c("year","ratio","country", "country.code")
data.by_country.average$category <- cut(data.by_country.average$mean,
breaks=c(-Inf,
quantile(data.by_country.average$mean, 0.25),
quantile(data.by_country.average$mean, 0.75),
Inf),
labels=c("low","medium","high"))
ggplot(data.by_country.average, aes(x=reorder(country, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
ggplot(subset(data, country.code %in% c('CZ', 'PT', 'BG', 'SK', 'ES', 'EE', 'EL', 'IE', 'MT')), aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = factor(country))) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data, aes(x = year, y = ratio * 100)) +
geom_point(aes(colour = factor(country))) +
geom_line(aes(colour = country)) +
stat_sum_single(mean, geom="line") +
theme_bw()
ggplot(data.by_country.average, aes(x=reorder(country, -mean), y = mean*100)) +
geom_bar(stat="identity", aes(fill = category)) +
theme_bw() +
theme(
panel.grid.major.y = element_line(colour = "black", linetype = 3, size = .5),
panel.background = element_blank(),
axis.title.x = element_text(size=16),
axis.text.x = element_text(size=14, angle=45, hjust=1, vjust=1),
axis.title.y = element_text(size=16, angle = 90),
axis.text.y = element_text(size=14),
strip.background = element_rect(color="white", fill="white"),
strip.text = element_text(size=16),
legend.position="right",
legend.direction = "vertical"
)
